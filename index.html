<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8"/>
    <title>Blockly Test</title>
    <script src="https://earnest-melomakarona-f2a498.netlify.app/blockly.min.js"></script>
    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }

        #blocklyDiv {
            height: calc(100% - 40px);
            width: 100%;
        }

        #buttonBar {
            height: 40px;
            background: #f3f3f3;
            display: flex;
            align-items: center;
            padding: 0 10px;
            gap: 10px;
            border-bottom: 1px solid #ccc;
        }

        button {
            padding: 6px 12px;
            cursor: pointer;
        }
    </style>
</head>
<body>

<div id="buttonBar">
    <button onclick="runCode()">실행</button>
    <button onclick="getCode()">블록 상태 확인</button>
</div>

<div id="blocklyDiv"></div>

<xml id="toolbox" style="display: none">
    <block type="controls_if"></block>
    <block type="logic_compare"></block>
    <block type="math_number"></block>
    <block type="text"></block>
    <block type="text_print"></block>
</xml>

<script>
    const workspace = Blockly.inject('blocklyDiv', {
        toolbox: document.getElementById('toolbox')
    });

    function runCode() {
        const code = Blockly.JavaScript.workspaceToCode(workspace);
        try {
            // 안전하게 eval로 실행 (보안상 sandbox 필요)
            eval(code);
        } catch (e) {
            alert("코드 실행 중 오류: " + e);
        }
    }

    function getCode() {
        const code = Blockly.JavaScript.workspaceToCode(workspace);
        console.log("JS 코드:", code);
        alert("콘솔창을 확인하세요!");
    }
</script>

</body>
</html>